# Документация устройства FlowerMonitoring 

## Энергонезависимая память микроконтроллера

Переменные, хранящиеся в EEPROM памяти Arduino Nano и необходимые для конфигурации устройства или подключению к сети ESP.

Пароль точки доступа ESP `ssidCLI` является константой во избежании ситуации, когда пользователь забывает этот пароль, и теряет возможность для подключения к точки доступа устройства для изменения пароля. Он находится на "коробке".

| # | Название | Системное имя | Тип | Длина |
|---|----------|---------------|-----|-------|
| 1 | IP / домен удалённого сервера | domen | String | 40 |
| 2 | Имя сети | ssidCLI | String | 20 |
| 3 | Пароль сети #2 | passwordCLI | String | 20 |
| 4 | Имя точки доступа ESP | ssidAP | String | 20 |

## Протокол общения Arduino Nano и ESP8266

По программному UART передаются сообщения вида `KEY:VALUE`.

| Сообщение | KEY | VALUE | Отправитель | Ответчик |
|-----------|-----|-------|-------------|----------|
| Переключение ESP в CLI мод | 1 | 1:`{domen}`;2:`{ssidCLI}`;3:`{passwordCLI}`; | Arduino | ESP |
| Переключение ESP в AP мод | 2 | 1:`{domen}`;2:`{ssidCLI}`;3:`{passwordCLI}`;4:`{ssidAP}`;5:`{passwordAP}`; | Arduino | ESP |
| Обновление полей в EEPROM | 3 | 1:`{domen}`;2:`{ssidCLI}`;3:`{passwordCLI}`;4:`{ssidAP}`; | ESP | Arduino |
| Вывод в монитор порта | 4 | Текст сообщения | ESP | Arduino |
| Статус получения | 5 | bool | Любой | Любой |

## Схемы

![Arduino Nano](images/nano.png)

![ESP8266](images/esp.png)

![Scheme](images/scheme.png)